---
title: "Assignment template"
author: "Group 45: Daniel Engbert, Rik Timmer, Koen van der Pool"
date: "11 February 2023"
output: pdf_document
fontsize: 11pt
highlight: tango
editor_options: 
  markdown: 
    wrap: 72
---

## Exercise 1: Birthweights

<!--# See template_assign_edda.Rmd for full tips and info for formatting this document -->

```{r}
data = read.table("birthweight.txt", header=T)
par(mfrow=c(1,2))
x = data$birthweight
# checking normality
hist(x, freq=F)
qqnorm(x)
shapiro.test(x)

res = t.test(x, conf.level=0.96)
res
sd(x)

tval = qt(0.98, length(x))
m = 50
n = (tval * sd(x) / m) ** 2
n
#sprintf("96% confidence interval: [%.4f, %.4f]", res$conf.int[1], res$conf.int[2])

```

**a)**

The birthweight data appears to be normal based on a normal-appearing
histogram, the straight line in the qqplot, and the shapiro-wilk
normality test (having \$p=0.8995 \> 0.05\$).

$$
m = \frac{t*s}{\sqrt{n}} \rightarrow n = (\frac{t * s}{m})^2
$$

The equation above, gives the sample size, \$n\$, needed for the
confidence interval to have a width of 100 (meaning \$m=50\$), where $t$
is the t-score for the quantile 0.02 (such that both tails of the
distribution have total area 0.04). Our calculations compute \$n =
832.32\$, which rounded indicates the min sample size is $n=833$ (for a
96% CI).

```{r}
B = 10000
Tstar = numeric(B)

for (i in 1:B){
  # sample with replacement, for a new sample of same length(x)
  Xstar = sample(x, replace=TRUE)
  Tstar[i] = mean(Xstar) 
}

Tstar02 = quantile(Tstar, 0.02)
Tstar04 = quantile(Tstar, 0.98)
Tstar02
Tstar04

```

Our bootstrap CI of 96% is $[2810.32, 3014.50]$ which is approximately
consistent with the CI calculated previously (as expected).

**b)**

Use wilcoxon sign test?

```{r}
t.test(x, mu=2800, alt="g")[[4]]
```

The output of the confidence interval here denotes that we can say with
95% confidence that the true mean is between
`r t.test(x, mu=2800, alt="g")[[4]]`.

```{r}
wilcox.test(x, mu=2800, alt="g")

```

As we previously determined, the data is approximately normally
distributed, and symmetric. Therefore the difference between the mean
and median is minimal, and we can use a Wilcoxon signed rank test for
one sample.

**c)**

```{r}

B = 10000; n = length(x)
psign=numeric(B) ## will contain p-values of sign test
pttest=numeric(B) ## will contain p-values of t-test
for(i in 1:B) {
  y = rnorm(n, mean=mean(x),sd=sd(x)) ## generate data under H1 with mu=0.5
  mu = 2800
  pttest[i] = t.test(y, mu=mu, alternative="greater")[[3]] ## extract p-value
  psign[i] = wilcox.test(y, mu=mu, alt="g")[[3]]
  #psign[i] = binom.test(sum(x>0),n,p=0.5)[[3]]
} ## extract p-value
sum(psign<0.05) / B
sum(pttest<0.05) / B
hist(psign)
hist(pttest)

```

**d)**

```{r}
pnorm(2600, mean = mean(x), sd=sd(x))
df = length(x) - 1
sd(x)
mean(x)

tval = (2600 - mean(x)) / sd(x)
tval
pt(-0.449, df=df)
  #qt(0.98, length(x))

```

## Exercise 2: Cholesterol

```{r,echo=FALSE,fig.height=3.5}
data = read.table("cholesterol.txt", header=T)
data
```

## Exercise 3: Diet

```{r}
data = read.table("diet.txt", header=T)
data
```

## Exercise 4: Yield of Peas

```{r}
library(MASS)
data = npk
data
```
