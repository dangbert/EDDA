---
title: "Assignment 1: Group 45"
author: "Daniel Engbert, Rik Timmer, Koen van der Pool"
date: "11 February 2023"
output: pdf_document
fontsize: 11pt
highlight: tango
editor_options: 
  markdown: 
    wrap: 72
---

## Exercise 1: Birthweights

<!--# See template_assign_edda.Rmd for full tips and info for formatting this document -->

**a)**

<!--# print(sprintf("96%% confidence interval: [%.4f, %.4f]", res$conf.int[1], res$conf.int[2])) -->

```{r}
data = read.table("birthweight.txt", header=T)
par(mfrow=c(1,2))
# use x as alias for the dataset
x = data$birthweight

# checking normality
hist(x, freq=F)
qqnorm(x)
shapiro.test(x)

t.test(x, conf.level=0.96)

# calculate min sample size needed
tval = qt(0.98, length(x))
m = 50
n = (tval * sd(x) / m) ** 2
print(sprintf("min sample size, n = %.2f", n))

```

The birthweight data appears to be normal based on a normal-appearing
histogram, the straight line in the qqplot, and the shapiro-wilk
normality test (having $p=0.8995 > 0.05$).

$$
m = \frac{t*s}{\sqrt{n}} \rightarrow n = (\frac{t * s}{m})^2
$$

The equation above, gives the sample size, $n$, needed for the
confidence interval to have a width of 100 (meaning $m=50$), where $t$
is the t-score for the quantile 0.02 (such that both tails of the
distribution have total area $1-0.96=0.04$). Our R code above computes
$n = 832.32$, which rounded up indicates the min sample size is $n=833$
(for a 96% CI of length at most 100).

```{r}
B = 10000
Tstar = numeric(B)
for (i in 1:B){
  # sample with replacement, for a new sample of same length(x)
  Xstar = sample(x, replace=TRUE)
  Tstar[i] = mean(Xstar) 
}

Tstar02 = quantile(Tstar, 0.02)
Tstar04 = quantile(Tstar, 0.98)
print(sprintf("Bootstrap 96%% CI = [%.2f, %.2f]", Tstar02, Tstar04))
```

The output of our bootstrap 96% CI indicates that we can say with 96%
confidence that the true mean weight of newborn babies is between
`r sprintf("[%.2f, %.2f]", Tstar02, Tstar04)` grams. This is
approximately consistent with the CI calculated previously (as
expected).

**b)**

```{r}
res = t.test(x, mu=2800, alt="g")
res #[[4]]
```

The output of the confidence interval here denotes that we can say with
95% confidence that the true mean is in the interval
`r sprintf("[%.4f, %.4f]", res$conf.int[[1]], res$conf.int[[2]])`, and
with a p-value of `r sprintf("%.4f", res$p.value)` \< 0.05, we can
accept the alternative hypothesis from the expert that the mean
birthweight $\mu > 2800$ grams.

As we previously determined, the data is approximately normally
distributed, and symmetric. Therefore the difference between the mean
and median is minimal, and we can use a Wilcoxon signed rank test for
one sample.

```{r}
res = wilcox.test(x, mu=2800, alt="g")
res
```

The resulting p-value of `r sprintf("%.4f", res$p.value)` \< 0.05 also
supports accepting the alternative hypothesis from the expert that
$\mu > 2800$ grams.

**c)**

```{r}

B = 10000; n = length(x)
psign=numeric(B) ## will contain p-values of sign test
pttest=numeric(B) ## will contain p-values of t-test
for(i in 1:B) {
  y = rnorm(n, mean=mean(x),sd=sd(x)) ## generate data under H1 with mu=0.5
  mu = 2800
  pttest[i] = t.test(y, mu=mu, alternative="greater")[[3]] ## extract p-value
  psign[i] = wilcox.test(y, mu=mu, alt="g")[[3]]
  #psign[i] = binom.test(sum(x>0),n,p=0.5)[[3]]
} ## extract p-value
sum(psign<0.05) / B
sum(pttest<0.05) / B
hist(psign)
hist(pttest)

```

**d)**

```{r}
pnorm(2600, mean = mean(x), sd=sd(x))
df = length(x) - 1
sd(x)
mean(x)

tval = (2600 - mean(x)) / sd(x)
tval
pt(-0.449, df=df)
  #qt(0.98, length(x))

```

## Exercise 2: Cholesterol

**a)**

```{r,echo=FALSE,fig.height=3.5}
data = read.table("cholesterol.txt", header=T)

plot(data$Before, data$After8weeks, main="Scatter Plot of Cholestrol Before vs After Treatment", xlab="Cholestrol Before (mmol/L)", ylab="Cholestrol After (mmol/L)")

# checking normality:
par(mfrow=c(1,2))
hist(data$Before, freq=F)
qqnorm(data$Before)
shapiro.test(data$Before)

hist(data$After8weeks, freq=F)
qqnorm(data$After8weeks)
shapiro.test(data$After8weeks)
```

Based on the histograms, qqplots and shapiro-Wilk normality test results
(both variables having $p>0.05$), both variables (`Before`,
`After8Weeks`) appear to be normally distributed.

As both variables appear to be normal, we can use the pearson's
correlation test to test the correlation between them.

```{r}
# TODO: use Pearsons' correlation test here

```

**b)**

In this experiment, the data are paired because a given index $i$ into
the two variables, contains a value measured from the same experimental
unit (person) before and after receiving a treatment (a low fat diet in
this case).

To investigate whether the diet had an effect, we can use a paired
t-test, and a TODO?? test.

TODO: explain $H_0$

```{r}

```

**c)**

```{r}

```

**d)**

```{r}

```

**e)**

```{r}

```

## Exercise 3: Diet

```{r}
data = read.table("diet.txt", header=T)
#data
```

## Exercise 4: Yield of Peas

```{r}
library(MASS)
data = npk
#data
```
